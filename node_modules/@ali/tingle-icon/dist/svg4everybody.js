'use strict';

/*! svg4everybody v2.0.3 | github.com/jonathantneal/svg4everybody */
// https://github.com/jonathantneal/svg4everybody.git
function embed(svg, target) {
	// if the target exists
	if (target) {
		// create a document fragment to hold the contents of the target
		var fragment = document.createDocumentFragment();

		// cache the closest matching viewBox
		var viewBox = !svg.getAttribute('viewBox') && target.getAttribute('viewBox');

		// conditionally set the viewBox on the svg
		if (viewBox) {
			svg.setAttribute('viewBox', viewBox);
		}

		// clone the target
		var clone = target.cloneNode(true);

		// copy the contents of the clone into the fragment
		while (clone.childNodes.length) {
			fragment.appendChild(clone.firstChild);
		}

		// append the fragment into the svg
		svg.appendChild(fragment);
	}
}

function loadreadystatechange(xhr) {
	// listen to changes in the request
	xhr.onreadystatechange = function () {
		// if the request is ready
		if (xhr.readyState === 4) {
			// get the cached html document
			var cachedDocument = xhr._cachedDocument;

			// ensure the cached html document based on the xhr response
			if (!cachedDocument) {
				cachedDocument = xhr._cachedDocument = document.implementation.createHTMLDocument('');

				cachedDocument.body.innerHTML = xhr.responseText;

				xhr._cachedTarget = {};
			}

			// clear the xhr embeds list and embed each item
			xhr._embeds.splice(0).map(function (item) {
				// get the cached target
				var target = xhr._cachedTarget[item.id];

				// ensure the cached target
				if (!target) {
					target = xhr._cachedTarget[item.id] = cachedDocument.getElementById(item.id);
				}

				// embed the target into the svg
				embed(item.svg, target);
			});
		}
	};

	// test the ready state change immediately
	xhr.onreadystatechange();
}

function svg4everybody(rawopts) {
	var opts = Object(rawopts);

	// create legacy support variables
	var nosvg;
	var fallback;

	// set whether the polyfill will be activated or not
	var polyfill;
	var olderIEUA = /\bMSIE [1-8]\.0\b/;
	var newerIEUA = /\bTrident\/[567]\b|\bMSIE (?:9|10)\.0\b/;
	var webkitUA = /\bAppleWebKit\/(\d+)\b/;
	var olderEdgeUA = /\bEdge\/12\.(\d+)\b/;

	if ('polyfill' in opts) {
		polyfill = opts.polyfill;
	} else {
		polyfill = newerIEUA.test(navigator.userAgent) || (navigator.userAgent.match(olderEdgeUA) || [])[1] < 10547 || (navigator.userAgent.match(webkitUA) || [])[1] < 537;
	}

	// create xhr requests object
	var requests = {};

	// use request animation frame or a timeout to search the dom for svgs
	var requestAnimationFrame = window.requestAnimationFrame || setTimeout;

	// get a live collection of use elements on the page
	var uses = document.getElementsByTagName('use');

	function oninterval() {
		// get the cached <use> index
		var index = 0;

		// while the index exists in the live <use> collection
		while (index < uses.length) {
			// get the current <use>
			var use = uses[index];

			// get the current <svg>
			var svg = use.parentNode;

			if (svg && /svg/i.test(svg.nodeName)) {
				var src = use.getAttribute('xlink:href');

				if (polyfill) {
					if (!opts.validate || opts.validate(src, svg, use)) {
						// remove the <use> element
						svg.removeChild(use);

						// parse the src and get the url and id
						var srcSplit = src.split('#');
						var url = srcSplit.shift();
						var id = srcSplit.join('#');

						// if the link is external
						if (url.length) {
							// get the cached xhr request
							var xhr = requests[url];

							// ensure the xhr request exists
							if (!xhr) {
								xhr = requests[url] = new XMLHttpRequest();

								xhr.open('GET', url);

								xhr.send();

								xhr._embeds = [];
							}

							// add the svg and id as an item to the xhr embeds list
							xhr._embeds.push({
								svg: svg,
								id: id
							});

							// prepare the xhr ready state change event
							loadreadystatechange(xhr);
						} else {
							// embed the local id into the svg
							embed(svg, document.getElementById(id));
						}
					}
				}
			} else {
				// increase the index when the previous value was not "valid"
				++index;
			}
		}

		// continue the interval
		requestAnimationFrame(oninterval, 67);
	}

	// conditionally start the interval if the polyfill is active
	if (polyfill) {
		oninterval();
	}
}

module.exports = svg4everybody;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN2ZzRldmVyeWJvZHkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUVBLFNBQVMsS0FBVCxDQUFlLEdBQWYsRUFBb0IsTUFBcEIsRUFBNEI7O0FBRTNCLEtBQUksTUFBSixFQUFZOztBQUVYLE1BQUksV0FBVyxTQUFTLHNCQUFULEVBQVg7OztBQUZPLE1BS1AsVUFBVSxDQUFDLElBQUksWUFBSixDQUFpQixTQUFqQixDQUFELElBQWdDLE9BQU8sWUFBUCxDQUFvQixTQUFwQixDQUFoQzs7O0FBTEgsTUFRUCxPQUFKLEVBQWE7QUFDWixPQUFJLFlBQUosQ0FBaUIsU0FBakIsRUFBNEIsT0FBNUIsRUFEWTtHQUFiOzs7QUFSVyxNQWFQLFFBQVEsT0FBTyxTQUFQLENBQWlCLElBQWpCLENBQVI7OztBQWJPLFNBZ0JKLE1BQU0sVUFBTixDQUFpQixNQUFqQixFQUF5QjtBQUMvQixZQUFTLFdBQVQsQ0FBcUIsTUFBTSxVQUFOLENBQXJCLENBRCtCO0dBQWhDOzs7QUFoQlcsS0FxQlgsQ0FBSSxXQUFKLENBQWdCLFFBQWhCLEVBckJXO0VBQVo7Q0FGRDs7QUEyQkEsU0FBUyxvQkFBVCxDQUE4QixHQUE5QixFQUFtQzs7QUFFbEMsS0FBSSxrQkFBSixHQUF5QixZQUFZOztBQUVwQyxNQUFJLElBQUksVUFBSixLQUFtQixDQUFuQixFQUFzQjs7QUFFekIsT0FBSSxpQkFBaUIsSUFBSSxlQUFKOzs7QUFGSSxPQUtyQixDQUFDLGNBQUQsRUFBaUI7QUFDcEIscUJBQWlCLElBQUksZUFBSixHQUFzQixTQUFTLGNBQVQsQ0FBd0Isa0JBQXhCLENBQTJDLEVBQTNDLENBQXRCLENBREc7O0FBR3BCLG1CQUFlLElBQWYsQ0FBb0IsU0FBcEIsR0FBZ0MsSUFBSSxZQUFKLENBSFo7O0FBS3BCLFFBQUksYUFBSixHQUFvQixFQUFwQixDQUxvQjtJQUFyQjs7O0FBTHlCLE1BY3pCLENBQUksT0FBSixDQUFZLE1BQVosQ0FBbUIsQ0FBbkIsRUFBc0IsR0FBdEIsQ0FBMEIsVUFBVSxJQUFWLEVBQWdCOztBQUV6QyxRQUFJLFNBQVMsSUFBSSxhQUFKLENBQWtCLEtBQUssRUFBTCxDQUEzQjs7O0FBRnFDLFFBS3JDLENBQUMsTUFBRCxFQUFTO0FBQ1osY0FBUyxJQUFJLGFBQUosQ0FBa0IsS0FBSyxFQUFMLENBQWxCLEdBQTZCLGVBQWUsY0FBZixDQUE4QixLQUFLLEVBQUwsQ0FBM0QsQ0FERztLQUFiOzs7QUFMeUMsU0FVekMsQ0FBTSxLQUFLLEdBQUwsRUFBVSxNQUFoQixFQVZ5QztJQUFoQixDQUExQixDQWR5QjtHQUExQjtFQUZ3Qjs7O0FBRlMsSUFrQ2xDLENBQUksa0JBQUosR0FsQ2tDO0NBQW5DOztBQXFDQSxTQUFTLGFBQVQsQ0FBdUIsT0FBdkIsRUFBZ0M7QUFDL0IsS0FBSSxPQUFPLE9BQU8sT0FBUCxDQUFQOzs7QUFEMkIsS0FJM0IsS0FBSixDQUorQjtBQUsvQixLQUFJLFFBQUo7OztBQUwrQixLQVEzQixRQUFKLENBUitCO0FBUy9CLEtBQUksWUFBWSxtQkFBWixDQVQyQjtBQVUvQixLQUFJLFlBQVkseUNBQVosQ0FWMkI7QUFXL0IsS0FBSSxXQUFXLHdCQUFYLENBWDJCO0FBWS9CLEtBQUksY0FBYyxxQkFBZCxDQVoyQjs7QUFjL0IsS0FBSSxjQUFjLElBQWQsRUFBb0I7QUFDdkIsYUFBVyxLQUFLLFFBQUwsQ0FEWTtFQUF4QixNQUVRO0FBQ1AsYUFBVyxVQUFVLElBQVYsQ0FBZSxVQUFVLFNBQVYsQ0FBZixJQUF1QyxDQUFDLFVBQVUsU0FBVixDQUFvQixLQUFwQixDQUEwQixXQUExQixLQUEwQyxFQUExQyxDQUFELENBQStDLENBQS9DLElBQW9ELEtBQXBELElBQTZELENBQUMsVUFBVSxTQUFWLENBQW9CLEtBQXBCLENBQTBCLFFBQTFCLEtBQXVDLEVBQXZDLENBQUQsQ0FBNEMsQ0FBNUMsSUFBaUQsR0FBakQsQ0FEeEc7RUFGUjs7O0FBZCtCLEtBcUIzQixXQUFXLEVBQVg7OztBQXJCMkIsS0F3QjNCLHdCQUF3QixPQUFPLHFCQUFQLElBQWdDLFVBQWhDOzs7QUF4QkcsS0EyQjNCLE9BQU8sU0FBUyxvQkFBVCxDQUE4QixLQUE5QixDQUFQLENBM0IyQjs7QUE2Qi9CLFVBQVMsVUFBVCxHQUFzQjs7QUFFckIsTUFBSSxRQUFRLENBQVI7OztBQUZpQixTQUtkLFFBQVEsS0FBSyxNQUFMLEVBQWE7O0FBRTNCLE9BQUksTUFBTSxLQUFLLEtBQUwsQ0FBTjs7O0FBRnVCLE9BS3ZCLE1BQU0sSUFBSSxVQUFKLENBTGlCOztBQU8zQixPQUFJLE9BQU8sT0FBTyxJQUFQLENBQVksSUFBSSxRQUFKLENBQW5CLEVBQWtDO0FBQ3JDLFFBQUksTUFBTSxJQUFJLFlBQUosQ0FBaUIsWUFBakIsQ0FBTixDQURpQzs7QUFHckMsUUFBSSxRQUFKLEVBQWM7QUFDYixTQUFJLENBQUMsS0FBSyxRQUFMLElBQWlCLEtBQUssUUFBTCxDQUFjLEdBQWQsRUFBbUIsR0FBbkIsRUFBd0IsR0FBeEIsQ0FBbEIsRUFBZ0Q7O0FBRW5ELFVBQUksV0FBSixDQUFnQixHQUFoQjs7O0FBRm1ELFVBSy9DLFdBQVcsSUFBSSxLQUFKLENBQVUsR0FBVixDQUFYLENBTCtDO0FBTW5ELFVBQUksTUFBTSxTQUFTLEtBQVQsRUFBTixDQU4rQztBQU9uRCxVQUFJLEtBQUssU0FBUyxJQUFULENBQWMsR0FBZCxDQUFMOzs7QUFQK0MsVUFVL0MsSUFBSSxNQUFKLEVBQVk7O0FBRWYsV0FBSSxNQUFNLFNBQVMsR0FBVCxDQUFOOzs7QUFGVyxXQUtYLENBQUMsR0FBRCxFQUFNO0FBQ1QsY0FBTSxTQUFTLEdBQVQsSUFBZ0IsSUFBSSxjQUFKLEVBQWhCLENBREc7O0FBR1QsWUFBSSxJQUFKLENBQVMsS0FBVCxFQUFnQixHQUFoQixFQUhTOztBQUtULFlBQUksSUFBSixHQUxTOztBQU9ULFlBQUksT0FBSixHQUFjLEVBQWQsQ0FQUztRQUFWOzs7QUFMZSxVQWdCZixDQUFJLE9BQUosQ0FBWSxJQUFaLENBQWlCO0FBQ2hCLGFBQUssR0FBTDtBQUNBLFlBQUksRUFBSjtRQUZEOzs7QUFoQmUsMkJBc0JmLENBQXFCLEdBQXJCLEVBdEJlO09BQWhCLE1BdUJPOztBQUVOLGFBQU0sR0FBTixFQUFXLFNBQVMsY0FBVCxDQUF3QixFQUF4QixDQUFYLEVBRk07T0F2QlA7TUFWRDtLQUREO0lBSEQsTUEyQ087O0FBRU4sTUFBRSxLQUFGLENBRk07SUEzQ1A7R0FQRDs7O0FBTHFCLHVCQThEckIsQ0FBc0IsVUFBdEIsRUFBa0MsRUFBbEMsRUE5RHFCO0VBQXRCOzs7QUE3QitCLEtBK0YzQixRQUFKLEVBQWM7QUFDYixlQURhO0VBQWQ7Q0EvRkQ7O0FBb0dBLE9BQU8sT0FBUCxHQUFpQixhQUFqQiIsImZpbGUiOiJzdmc0ZXZlcnlib2R5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIHN2ZzRldmVyeWJvZHkgdjIuMC4zIHwgZ2l0aHViLmNvbS9qb25hdGhhbnRuZWFsL3N2ZzRldmVyeWJvZHkgKi9cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qb25hdGhhbnRuZWFsL3N2ZzRldmVyeWJvZHkuZ2l0XG5mdW5jdGlvbiBlbWJlZChzdmcsIHRhcmdldCkge1xuXHQvLyBpZiB0aGUgdGFyZ2V0IGV4aXN0c1xuXHRpZiAodGFyZ2V0KSB7XG5cdFx0Ly8gY3JlYXRlIGEgZG9jdW1lbnQgZnJhZ21lbnQgdG8gaG9sZCB0aGUgY29udGVudHMgb2YgdGhlIHRhcmdldFxuXHRcdHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuXHRcdC8vIGNhY2hlIHRoZSBjbG9zZXN0IG1hdGNoaW5nIHZpZXdCb3hcblx0XHR2YXIgdmlld0JveCA9ICFzdmcuZ2V0QXR0cmlidXRlKCd2aWV3Qm94JykgJiYgdGFyZ2V0LmdldEF0dHJpYnV0ZSgndmlld0JveCcpO1xuXG5cdFx0Ly8gY29uZGl0aW9uYWxseSBzZXQgdGhlIHZpZXdCb3ggb24gdGhlIHN2Z1xuXHRcdGlmICh2aWV3Qm94KSB7XG5cdFx0XHRzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94Jywgdmlld0JveCk7XG5cdFx0fVxuXG5cdFx0Ly8gY2xvbmUgdGhlIHRhcmdldFxuXHRcdHZhciBjbG9uZSA9IHRhcmdldC5jbG9uZU5vZGUodHJ1ZSk7XG5cblx0XHQvLyBjb3B5IHRoZSBjb250ZW50cyBvZiB0aGUgY2xvbmUgaW50byB0aGUgZnJhZ21lbnRcblx0XHR3aGlsZSAoY2xvbmUuY2hpbGROb2Rlcy5sZW5ndGgpIHtcblx0XHRcdGZyYWdtZW50LmFwcGVuZENoaWxkKGNsb25lLmZpcnN0Q2hpbGQpO1xuXHRcdH1cblxuXHRcdC8vIGFwcGVuZCB0aGUgZnJhZ21lbnQgaW50byB0aGUgc3ZnXG5cdFx0c3ZnLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblx0fVxufVxuXG5mdW5jdGlvbiBsb2FkcmVhZHlzdGF0ZWNoYW5nZSh4aHIpIHtcblx0Ly8gbGlzdGVuIHRvIGNoYW5nZXMgaW4gdGhlIHJlcXVlc3Rcblx0eGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcblx0XHQvLyBpZiB0aGUgcmVxdWVzdCBpcyByZWFkeVxuXHRcdGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuXHRcdFx0Ly8gZ2V0IHRoZSBjYWNoZWQgaHRtbCBkb2N1bWVudFxuXHRcdFx0dmFyIGNhY2hlZERvY3VtZW50ID0geGhyLl9jYWNoZWREb2N1bWVudDtcblxuXHRcdFx0Ly8gZW5zdXJlIHRoZSBjYWNoZWQgaHRtbCBkb2N1bWVudCBiYXNlZCBvbiB0aGUgeGhyIHJlc3BvbnNlXG5cdFx0XHRpZiAoIWNhY2hlZERvY3VtZW50KSB7XG5cdFx0XHRcdGNhY2hlZERvY3VtZW50ID0geGhyLl9jYWNoZWREb2N1bWVudCA9IGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgnJyk7XG5cblx0XHRcdFx0Y2FjaGVkRG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSB4aHIucmVzcG9uc2VUZXh0O1xuXG5cdFx0XHRcdHhoci5fY2FjaGVkVGFyZ2V0ID0ge307XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNsZWFyIHRoZSB4aHIgZW1iZWRzIGxpc3QgYW5kIGVtYmVkIGVhY2ggaXRlbVxuXHRcdFx0eGhyLl9lbWJlZHMuc3BsaWNlKDApLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHQvLyBnZXQgdGhlIGNhY2hlZCB0YXJnZXRcblx0XHRcdFx0dmFyIHRhcmdldCA9IHhoci5fY2FjaGVkVGFyZ2V0W2l0ZW0uaWRdO1xuXG5cdFx0XHRcdC8vIGVuc3VyZSB0aGUgY2FjaGVkIHRhcmdldFxuXHRcdFx0XHRpZiAoIXRhcmdldCkge1xuXHRcdFx0XHRcdHRhcmdldCA9IHhoci5fY2FjaGVkVGFyZ2V0W2l0ZW0uaWRdID0gY2FjaGVkRG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaXRlbS5pZCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBlbWJlZCB0aGUgdGFyZ2V0IGludG8gdGhlIHN2Z1xuXHRcdFx0XHRlbWJlZChpdGVtLnN2ZywgdGFyZ2V0KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcblxuXHQvLyB0ZXN0IHRoZSByZWFkeSBzdGF0ZSBjaGFuZ2UgaW1tZWRpYXRlbHlcblx0eGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSgpO1xufVxuXG5mdW5jdGlvbiBzdmc0ZXZlcnlib2R5KHJhd29wdHMpIHtcblx0dmFyIG9wdHMgPSBPYmplY3QocmF3b3B0cyk7XG5cblx0Ly8gY3JlYXRlIGxlZ2FjeSBzdXBwb3J0IHZhcmlhYmxlc1xuXHR2YXIgbm9zdmc7XG5cdHZhciBmYWxsYmFjaztcblxuXHQvLyBzZXQgd2hldGhlciB0aGUgcG9seWZpbGwgd2lsbCBiZSBhY3RpdmF0ZWQgb3Igbm90XG5cdHZhciBwb2x5ZmlsbDtcblx0dmFyIG9sZGVySUVVQSA9IC9cXGJNU0lFIFsxLThdXFwuMFxcYi87XG5cdHZhciBuZXdlcklFVUEgPSAvXFxiVHJpZGVudFxcL1s1NjddXFxifFxcYk1TSUUgKD86OXwxMClcXC4wXFxiLztcblx0dmFyIHdlYmtpdFVBID0gL1xcYkFwcGxlV2ViS2l0XFwvKFxcZCspXFxiLztcblx0dmFyIG9sZGVyRWRnZVVBID0gL1xcYkVkZ2VcXC8xMlxcLihcXGQrKVxcYi87XG5cblx0aWYgKCdwb2x5ZmlsbCcgaW4gb3B0cykge1xuXHRcdHBvbHlmaWxsID0gb3B0cy5wb2x5ZmlsbDtcblx0fSAgZWxzZSB7XG5cdFx0cG9seWZpbGwgPSBuZXdlcklFVUEudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSB8fCAobmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaChvbGRlckVkZ2VVQSkgfHwgW10pWzFdIDwgMTA1NDcgfHwgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2god2Via2l0VUEpIHx8IFtdKVsxXSA8IDUzNztcblx0fVxuXG5cdC8vIGNyZWF0ZSB4aHIgcmVxdWVzdHMgb2JqZWN0XG5cdHZhciByZXF1ZXN0cyA9IHt9O1xuXG5cdC8vIHVzZSByZXF1ZXN0IGFuaW1hdGlvbiBmcmFtZSBvciBhIHRpbWVvdXQgdG8gc2VhcmNoIHRoZSBkb20gZm9yIHN2Z3Ncblx0dmFyIHJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgc2V0VGltZW91dDtcblxuXHQvLyBnZXQgYSBsaXZlIGNvbGxlY3Rpb24gb2YgdXNlIGVsZW1lbnRzIG9uIHRoZSBwYWdlXG5cdHZhciB1c2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3VzZScpO1xuXG5cdGZ1bmN0aW9uIG9uaW50ZXJ2YWwoKSB7XG5cdFx0Ly8gZ2V0IHRoZSBjYWNoZWQgPHVzZT4gaW5kZXhcblx0XHR2YXIgaW5kZXggPSAwO1xuXG5cdFx0Ly8gd2hpbGUgdGhlIGluZGV4IGV4aXN0cyBpbiB0aGUgbGl2ZSA8dXNlPiBjb2xsZWN0aW9uXG5cdFx0d2hpbGUgKGluZGV4IDwgdXNlcy5sZW5ndGgpIHtcblx0XHRcdC8vIGdldCB0aGUgY3VycmVudCA8dXNlPlxuXHRcdFx0dmFyIHVzZSA9IHVzZXNbaW5kZXhdO1xuXG5cdFx0XHQvLyBnZXQgdGhlIGN1cnJlbnQgPHN2Zz5cblx0XHRcdHZhciBzdmcgPSB1c2UucGFyZW50Tm9kZTtcblxuXHRcdFx0aWYgKHN2ZyAmJiAvc3ZnL2kudGVzdChzdmcubm9kZU5hbWUpKSB7XG5cdFx0XHRcdHZhciBzcmMgPSB1c2UuZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJyk7XG5cblx0XHRcdFx0aWYgKHBvbHlmaWxsKSB7XG5cdFx0XHRcdFx0aWYgKCFvcHRzLnZhbGlkYXRlIHx8IG9wdHMudmFsaWRhdGUoc3JjLCBzdmcsIHVzZSkpIHtcblx0XHRcdFx0XHRcdC8vIHJlbW92ZSB0aGUgPHVzZT4gZWxlbWVudFxuXHRcdFx0XHRcdFx0c3ZnLnJlbW92ZUNoaWxkKHVzZSk7XG5cblx0XHRcdFx0XHRcdC8vIHBhcnNlIHRoZSBzcmMgYW5kIGdldCB0aGUgdXJsIGFuZCBpZFxuXHRcdFx0XHRcdFx0dmFyIHNyY1NwbGl0ID0gc3JjLnNwbGl0KCcjJyk7XG5cdFx0XHRcdFx0XHR2YXIgdXJsID0gc3JjU3BsaXQuc2hpZnQoKTtcblx0XHRcdFx0XHRcdHZhciBpZCA9IHNyY1NwbGl0LmpvaW4oJyMnKTtcblxuXHRcdFx0XHRcdFx0Ly8gaWYgdGhlIGxpbmsgaXMgZXh0ZXJuYWxcblx0XHRcdFx0XHRcdGlmICh1cmwubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdC8vIGdldCB0aGUgY2FjaGVkIHhociByZXF1ZXN0XG5cdFx0XHRcdFx0XHRcdHZhciB4aHIgPSByZXF1ZXN0c1t1cmxdO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGVuc3VyZSB0aGUgeGhyIHJlcXVlc3QgZXhpc3RzXG5cdFx0XHRcdFx0XHRcdGlmICgheGhyKSB7XG5cdFx0XHRcdFx0XHRcdFx0eGhyID0gcmVxdWVzdHNbdXJsXSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG5cdFx0XHRcdFx0XHRcdFx0eGhyLm9wZW4oJ0dFVCcsIHVybCk7XG5cblx0XHRcdFx0XHRcdFx0XHR4aHIuc2VuZCgpO1xuXG5cdFx0XHRcdFx0XHRcdFx0eGhyLl9lbWJlZHMgPSBbXTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIGFkZCB0aGUgc3ZnIGFuZCBpZCBhcyBhbiBpdGVtIHRvIHRoZSB4aHIgZW1iZWRzIGxpc3Rcblx0XHRcdFx0XHRcdFx0eGhyLl9lbWJlZHMucHVzaCh7XG5cdFx0XHRcdFx0XHRcdFx0c3ZnOiBzdmcsXG5cdFx0XHRcdFx0XHRcdFx0aWQ6IGlkXG5cdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHByZXBhcmUgdGhlIHhociByZWFkeSBzdGF0ZSBjaGFuZ2UgZXZlbnRcblx0XHRcdFx0XHRcdFx0bG9hZHJlYWR5c3RhdGVjaGFuZ2UoeGhyKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIGVtYmVkIHRoZSBsb2NhbCBpZCBpbnRvIHRoZSBzdmdcblx0XHRcdFx0XHRcdFx0ZW1iZWQoc3ZnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gaW5jcmVhc2UgdGhlIGluZGV4IHdoZW4gdGhlIHByZXZpb3VzIHZhbHVlIHdhcyBub3QgXCJ2YWxpZFwiXG5cdFx0XHRcdCsraW5kZXg7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gY29udGludWUgdGhlIGludGVydmFsXG5cdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKG9uaW50ZXJ2YWwsIDY3KTtcblx0fVxuXG5cdC8vIGNvbmRpdGlvbmFsbHkgc3RhcnQgdGhlIGludGVydmFsIGlmIHRoZSBwb2x5ZmlsbCBpcyBhY3RpdmVcblx0aWYgKHBvbHlmaWxsKSB7XG5cdFx0b25pbnRlcnZhbCgpO1xuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3ZnNGV2ZXJ5Ym9keTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
