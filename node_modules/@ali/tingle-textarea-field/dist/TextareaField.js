'use strict';

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * TextareaField Component for tingle
 * @author zhangshun@alipay.com
 *
 * Copyright 2014-2016, Tingle Team.
 * All rights reserved.
 */
var React = require('react');
var classnames = require('classnames');
var Context = require('@ali/tingle-context');
var calculateHeight = require('./calculateHeight');
var Field = require('@ali/tingle-field');

var prefixClass = Context.prefixClass;

var TextareaField = function (_React$Component) {
    _inherits(TextareaField, _React$Component);

    function TextareaField(props) {
        _classCallCheck(this, TextareaField);

        var _this = _possibleConstructorReturn(this, (TextareaField.__proto__ || Object.getPrototypeOf(TextareaField)).call(this, props));

        _this.state = {
            height: null,
            rows: 1
        };
        return _this;
    }

    _createClass(TextareaField, [{
        key: 'componentDidMount',
        value: function componentDidMount() {
            this._resize();
        }
    }, {
        key: 'componentWillReceiveProps',
        value: function componentWillReceiveProps(nextProps) {
            if ('value' in nextProps) {
                this._resize();
            }
        }
    }, {
        key: '_resize',
        value: function _resize() {
            this.setState(calculateHeight(ReactDOM.findDOMNode(this.refs.textarea), this.props.minRows || this.props.rows, this.props.maxRows));
        }
    }, {
        key: 'handleChange',
        value: function handleChange(e) {
            this._resize();
            this.props.onChange(e.target.value, e);
        }
    }, {
        key: 'handleFocus',
        value: function handleFocus(e) {
            this.props.onFocus(e);
        }
    }, {
        key: 'handleBlur',
        value: function handleBlur(e) {
            this.props.onBlur(e);
        }
    }, {
        key: 'render',
        value: function render() {
            var _classnames;

            var t = this;
            var _t$props = t.props,
                placeholder = _t$props.placeholder,
                label = _t$props.label,
                readOnly = _t$props.readOnly,
                lineHeight = _t$props.lineHeight;

            var style = {
                //height: t.state.height,
                lineHeight: lineHeight
            };

            return React.createElement(
                Field,
                _extends({}, t.props, { multiLine: true, className: classnames((_classnames = {}, _defineProperty(_classnames, prefixClass('textarea-field'), true), _defineProperty(_classnames, 'readonly', readOnly), _defineProperty(_classnames, t.props.className, !!t.props.className), _classnames)) }),
                React.createElement('textarea', { ref: 'textarea',
                    className: prefixClass('textarea-field-content'),
                    style: style,
                    placeholder: placeholder,
                    value: t.props.value,
                    readOnly: readOnly,
                    rows: t.state.rows,
                    onChange: t.handleChange.bind(t),
                    onFocus: t.handleFocus.bind(t),
                    onBlur: t.handleBlur.bind(t) })
            );
        }
    }]);

    return TextareaField;
}(React.Component);

;

TextareaField.defaultProps = {
    placeholder: '',
    onChange: Context.noop,
    onFocus: Context.noop,
    onBlur: Context.noop,
    readOnly: false,
    minRows: 1,
    maxRows: 10,
    lineHeight: '1.3',
    value: ''
};

// http://facebook.github.io/react/docs/reusable-components.html
TextareaField.propTypes = {
    value: React.PropTypes.string,
    placeholder: React.PropTypes.string,
    onChange: React.PropTypes.func,
    onFocus: React.PropTypes.func,
    onBlur: React.PropTypes.func,
    readOnly: React.PropTypes.bool,
    minRows: React.PropTypes.number,
    maxRows: React.PropTypes.number,
    lineHeight: React.PropTypes.string,
    className: React.PropTypes.string
};

TextareaField.displayName = 'TextareaField';

module.exports = TextareaField;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRleHRhcmVhRmllbGQuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJyZXF1aXJlIiwiY2xhc3NuYW1lcyIsIkNvbnRleHQiLCJjYWxjdWxhdGVIZWlnaHQiLCJGaWVsZCIsInByZWZpeENsYXNzIiwiVGV4dGFyZWFGaWVsZCIsInByb3BzIiwic3RhdGUiLCJoZWlnaHQiLCJyb3dzIiwiX3Jlc2l6ZSIsIm5leHRQcm9wcyIsInNldFN0YXRlIiwiUmVhY3RET00iLCJmaW5kRE9NTm9kZSIsInJlZnMiLCJ0ZXh0YXJlYSIsIm1pblJvd3MiLCJtYXhSb3dzIiwiZSIsIm9uQ2hhbmdlIiwidGFyZ2V0IiwidmFsdWUiLCJvbkZvY3VzIiwib25CbHVyIiwidCIsInBsYWNlaG9sZGVyIiwibGFiZWwiLCJyZWFkT25seSIsImxpbmVIZWlnaHQiLCJzdHlsZSIsImNsYXNzTmFtZSIsImhhbmRsZUNoYW5nZSIsImJpbmQiLCJoYW5kbGVGb2N1cyIsImhhbmRsZUJsdXIiLCJDb21wb25lbnQiLCJkZWZhdWx0UHJvcHMiLCJub29wIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwic3RyaW5nIiwiZnVuYyIsImJvb2wiLCJudW1iZXIiLCJkaXNwbGF5TmFtZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7QUFPQSxJQUFNQSxRQUFRQyxRQUFRLE9BQVIsQ0FBZDtBQUNBLElBQU1DLGFBQWFELFFBQVEsWUFBUixDQUFuQjtBQUNBLElBQU1FLFVBQVVGLFFBQVEscUJBQVIsQ0FBaEI7QUFDQSxJQUFNRyxrQkFBa0JILFFBQVEsbUJBQVIsQ0FBeEI7QUFDQSxJQUFNSSxRQUFRSixRQUFRLG1CQUFSLENBQWQ7O0FBRUEsSUFBSUssY0FBY0gsUUFBUUcsV0FBMUI7O0lBRU1DLGE7OztBQUVGLDJCQUFZQyxLQUFaLEVBQW1CO0FBQUE7O0FBQUEsa0lBQ1RBLEtBRFM7O0FBRWYsY0FBS0MsS0FBTCxHQUFhO0FBQ1RDLG9CQUFRLElB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QUFOLENBQWdCRSxJQUxGO0FBTXRCZCxjQUFVOUIsTUFBTTBDLFNBQU4sQ0FBZ0JHLElBTko7QUFPdEIxQixhQUFTbkIsTUFBTTBDLFNBQU4sQ0FBZ0JJLE1BUEg7QUFRdEIxQixhQUFTcEIsTUFBTTBDLFNBQU4sQ0FBZ0JJLE1BUkg7QUFTdEJmLGdCQUFZL0IsTUFBTTBDLFNBQU4sQ0FBZ0JDLE1BVE47QUFVdEJWLGVBQVdqQyxNQUFNMEMsU0FBTixDQUFnQkM7QUFWTCxDQUExQjs7QUFhQXBDLGNBQWN3QyxXQUFkLEdBQTRCLGVBQTVCOztBQUVBQyxPQUFPQyxPQUFQLEdBQWlCMUMsYUFBakIiLCJmaWxlIjoiVGV4dGFyZWFGaWVsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGV4dGFyZWFGaWVsZCBDb21wb25lbnQgZm9yIHRpbmdsZVxuICogQGF1dGhvciB6aGFuZ3NodW5AYWxpcGF5LmNvbVxuICpcbiAqIENvcHlyaWdodCAyMDE0LTIwMTYsIFRpbmdsZSBUZWFtLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuY29uc3QgY2xhc3NuYW1lcyA9IHJlcXVpcmUoJ2NsYXNzbmFtZXMnKTtcbmNvbnN0IENvbnRleHQgPSByZXF1aXJlKCdAYWxpL3RpbmdsZS1jb250ZXh0Jyk7XG5jb25zdCBjYWxjdWxhdGVIZWlnaHQgPSByZXF1aXJlKCcuL2NhbGN1bGF0ZUhlaWdodCcpO1xuY29uc3QgRmllbGQgPSByZXF1aXJlKCdAYWxpL3RpbmdsZS1maWVsZCcpO1xuXG5sZXQgcHJlZml4Q2xhc3MgPSBDb250ZXh0LnByZWZpeENsYXNzO1xuXG5jbGFzcyBUZXh0YXJlYUZpZWxkIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGhlaWdodDogbnVsbCxcbiAgICAgICAgICAgIHJvd3M6MVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLl9yZXNpemUoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBpZiAoJ3ZhbHVlJyBpbiBuZXh0UHJvcHMpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3Jlc2l6ZSgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgICAgICAgIGNhbGN1bGF0ZUhlaWdodChSZWFjdERPTS5maW5kRE9NTm9kZSh0aGlzLnJlZnMudGV4dGFyZWEpLCB0aGlzLnByb3BzLm1pblJvd3MgfHwgdGhpcy5wcm9wcy5yb3dzLCB0aGlzLnByb3BzLm1heFJvd3MpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgaGFuZGxlQ2hhbmdlKGUpIHtcbiAgICAgICAgdGhpcy5fcmVzaXplKCk7XG4gICAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UoZS50YXJnZXQudmFsdWUsIGUpO1xuICAgIH1cblxuICAgIGhhbmRsZUZvY3VzKGUpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5vbkZvY3VzKGUpO1xuICAgIH1cblxuICAgIGhhbmRsZUJsdXIoZSkge1xuICAgICAgICB0aGlzLnByb3BzLm9uQmx1cihlKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcztcbiAgICAgICAgbGV0IHsgcGxhY2Vob2xkZXIsIGxhYmVsLCByZWFkT25seSwgbGluZUhlaWdodCB9ID0gdC5wcm9wcztcbiAgICAgICAgbGV0IHN0eWxlID0ge1xuICAgICAgICAgICAgLy9oZWlnaHQ6IHQuc3RhdGUuaGVpZ2h0LFxuICAgICAgICAgICAgbGluZUhlaWdodDpsaW5lSGVpZ2h0XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxGaWVsZCB7Li4udC5wcm9wc30gbXVsdGlMaW5lPXt0cnVlfSBjbGFzc05hbWU9e2NsYXNzbmFtZXMoe1xuICAgICAgICAgICAgICAgIFtwcmVmaXhDbGFzcygndGV4dGFyZWEtZmllbGQnKV06IHRydWUsXG4gICAgICAgICAgICAgICAgcmVhZG9ubHk6IHJlYWRPbmx5LFxuICAgICAgICAgICAgICAgIFt0LnByb3BzLmNsYXNzTmFtZV06ICEhdC5wcm9wcy5jbGFzc05hbWVcbiAgICAgICAgICAgIH0pfT5cbiAgICAgICAgICAgICAgICA8dGV4dGFyZWEgcmVmPVwidGV4dGFyZWFcIlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3ByZWZpeENsYXNzKCd0ZXh0YXJlYS1maWVsZC1jb250ZW50Jyl9XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXtzdHlsZX1cbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3BsYWNlaG9sZGVyfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dC5wcm9wcy52YWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9e3JlYWRPbmx5fVxuICAgICAgICAgICAgICAgICAgICByb3dzPXt0LnN0YXRlLnJvd3N9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0LmhhbmRsZUNoYW5nZS5iaW5kKHQpfVxuICAgICAgICAgICAgICAgICAgICBvbkZvY3VzPXt0LmhhbmRsZUZvY3VzLmJpbmQodCl9XG4gICAgICAgICAgICAgICAgICAgIG9uQmx1cj17dC5oYW5kbGVCbHVyLmJpbmQodCl9Lz5cbiAgICAgICAgICAgIDwvRmllbGQ+XG4gICAgICAgICk7XG4gICAgfVxufTtcblxuVGV4dGFyZWFGaWVsZC5kZWZhdWx0UHJvcHMgPSB7XG4gICAgcGxhY2Vob2xkZXI6ICcnLFxuICAgIG9uQ2hhbmdlOiBDb250ZXh0Lm5vb3AsXG4gICAgb25Gb2N1czogQ29udGV4dC5ub29wLFxuICAgIG9uQmx1cjogQ29udGV4dC5ub29wLFxuICAgIHJlYWRPbmx5OiBmYWxzZSxcbiAgICBtaW5Sb3dzOiAxLFxuICAgIG1heFJvd3M6IDEwLFxuICAgIGxpbmVIZWlnaHQ6JzEuMycsXG4gICAgdmFsdWU6ICcnXG59O1xuXG4vLyBodHRwOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0L2RvY3MvcmV1c2FibGUtY29tcG9uZW50cy5odG1sXG5UZXh0YXJlYUZpZWxkLnByb3BUeXBlcyA9IHtcbiAgICB2YWx1ZTogUmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcbiAgICBwbGFjZWhvbGRlcjogUmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcbiAgICBvbkNoYW5nZTogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25Gb2N1czogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25CbHVyOiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcbiAgICByZWFkT25seTogUmVhY3QuUHJvcFR5cGVzLmJvb2wsXG4gICAgbWluUm93czogUmVhY3QuUHJvcFR5cGVzLm51bWJlcixcbiAgICBtYXhSb3dzOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgIGxpbmVIZWlnaHQ6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcsXG4gICAgY2xhc3NOYW1lOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nXG59O1xuXG5UZXh0YXJlYUZpZWxkLmRpc3BsYXlOYW1lID0gJ1RleHRhcmVhRmllbGQnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRleHRhcmVhRmllbGQ7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
