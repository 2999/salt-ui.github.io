'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _classnames2 = require('classnames');

var _classnames3 = _interopRequireDefault(_classnames2);

var _tingleContext = require('@ali/tingle-context');

var _tingleContext2 = _interopRequireDefault(_tingleContext);

var _tingleBox = require('@ali/tingle-box');

var _TabBarItem = require('./TabBarItem');

var _TabBarItem2 = _interopRequireDefault(_TabBarItem);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * TabBar Component for tingle
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zhouwenjie
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2014-2016, Tingle Team.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * All rights reserved.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */


var TabBar = function (_React$Component) {
    _inherits(TabBar, _React$Component);

    function TabBar(props) {
        _classCallCheck(this, TabBar);

        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(TabBar).call(this, props));

        _this.state = {
            activeIndex: props.activeIndex
        };
        return _this;
    }

    _createClass(TabBar, [{
        key: 'componentWillReceiveProps',
        value: function componentWillReceiveProps(nextProps) {
            var t = this;
            var nextActiveIndex = nextProps.activeIndex;
            if (nextActiveIndex !== t.state.activeIndex) {
                t.setActiveIndex(nextActiveIndex);
            }
        }
    }, {
        key: 'onItemClick',
        value: function onItemClick(index) {
            if (index !== this.state.activeIndex) {
                this.setActiveIndex(index);
            }
        }
    }, {
        key: 'setActiveIndex',
        value: function setActiveIndex(index) {
            var t = this;
            t.setState({
                activeIndex: index
            }, function () {
                t.props.onChange(index);
            });
        }
    }, {
        key: 'renderItems',
        value: function renderItems() {
            var t = this;
            return _react2.default.createElement(
                _tingleBox.HBox,
                {
                    className: _tingleContext2.default.prefixClass('tab-bar-items'),
                    hAlign: 'center',
                    vAlign: 'center'
                },
                _react2.default.Children.map(t.props.children, function (child, idx) {
                    if (!child) {
                        return null;
                    }
                    return _react2.default.createElement(_TabBarItem2.default, {
                        key: idx,
                        item: child,
                        active: idx === t.state.activeIndex,
                        onClick: t.onItemClick.bind(t, idx)
                    });
                })
            );
        }
    }, {
        key: 'renderContents',
        value: function renderContents() {
            var t = this;
            return _react2.default.createElement(
                'div',
                { className: _tingleContext2.default.prefixClass('tab-bar-contents') },
                _react2.default.Children.map(t.props.children, function (child, idx) {
                    if (!child) {
                        return null;
                    }
                    return _react2.default.createElement(
                        'div',
                        { key: idx, className: (0, _classnames3.default)(_tingleContext2.default.prefixClass('tab-bar-content'), {
                                'active': idx === t.state.activeIndex
                            }) },
                        child.props && child.props.children
                    );
                })
            );
        }
    }, {
        key: 'render',
        value: function render() {
            var t = this;
            return _react2.default.createElement(
                'div',
                { ref: 'root', className: (0, _classnames3.default)(_tingleContext2.default.prefixClass('tab-bar'), _defineProperty({}, t.props.className, !!t.props.className)) },
                t.renderContents(),
                t.renderItems()
            );
        }
    }]);

    return TabBar;
}(_react2.default.Component);

TabBar.displayName = 'TabBar';
TabBar.defaultProps = {
    activeIndex: 0,
    onChange: function onChange() {}
};
TabBar.propTypes = {
    className: _react2.default.PropTypes.string,
    activeIndex: _react2.default.PropTypes.number,
    onChange: _react2.default.PropTypes.func
};

TabBar.Item = _TabBarItem2.default;

exports.default = TabBar;
//# sourceMappingURL=data:application/json;base64,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SztBQUVsQixjQUFVLG9CQUFLLENBQ2Q7QUFIaUIsQztBQUZwQixNLENBT0ssUyxHQUFZO0FBQ2YsZUFBVyxnQkFBTSxTQUFOLENBQWdCLE1BRFo7QUFFZixpQkFBYSxnQkFBTSxTQUFOLENBQWdCLE1BRmQ7QUFHZixjQUFVLGdCQUFNLFNBQU4sQ0FBZ0I7QUFIWCxDOztBQXVGdkIsT0FBTyxJQUFQOztrQkFFZSxNIiwiZmlsZSI6IlRhYkJhci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGFiQmFyIENvbXBvbmVudCBmb3IgdGluZ2xlXG4gKiBAYXV0aG9yIHpob3V3ZW5qaWVcbiAqXG4gKiBDb3B5cmlnaHQgMjAxNC0yMDE2LCBUaW5nbGUgVGVhbS5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBDb250ZXh0IGZyb20gJ0BhbGkvdGluZ2xlLWNvbnRleHQnO1xuaW1wb3J0IHtIQm94fSBmcm9tICdAYWxpL3RpbmdsZS1ib3gnO1xuaW1wb3J0IFRhYkJhckl0ZW0gZnJvbSAnLi9UYWJCYXJJdGVtJztcblxuY2xhc3MgVGFiQmFyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgZGlzcGxheU5hbWUgPSAnVGFiQmFyJztcbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBhY3RpdmVJbmRleDogMCxcbiAgICAgICAgb25DaGFuZ2U6ICgpPT4ge1xuICAgICAgICB9LFxuICAgIH07XG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgY2xhc3NOYW1lOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuICAgICAgICBhY3RpdmVJbmRleDogUmVhY3QuUHJvcFR5cGVzLm51bWJlcixcbiAgICAgICAgb25DaGFuZ2U6IFJlYWN0LlByb3BUeXBlcy5mdW5jLFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBhY3RpdmVJbmRleDogcHJvcHMuYWN0aXZlSW5kZXgsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBsZXQgdCA9IHRoaXM7XG4gICAgICAgIGNvbnN0IG5leHRBY3RpdmVJbmRleCA9IG5leHRQcm9wcy5hY3RpdmVJbmRleDtcbiAgICAgICAgaWYgKG5leHRBY3RpdmVJbmRleCAhPT0gdC5zdGF0ZS5hY3RpdmVJbmRleCkge1xuICAgICAgICAgICAgdC5zZXRBY3RpdmVJbmRleChuZXh0QWN0aXZlSW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25JdGVtQ2xpY2soaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ICE9PSB0aGlzLnN0YXRlLmFjdGl2ZUluZGV4KSB7XG4gICAgICAgICAgICB0aGlzLnNldEFjdGl2ZUluZGV4KGluZGV4KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldEFjdGl2ZUluZGV4KGluZGV4KSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzO1xuICAgICAgICB0LnNldFN0YXRlKHtcbiAgICAgICAgICAgIGFjdGl2ZUluZGV4OiBpbmRleFxuICAgICAgICB9LCAoKT0+IHtcbiAgICAgICAgICAgIHQucHJvcHMub25DaGFuZ2UoaW5kZXgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXJJdGVtcygpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8SEJveFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Q29udGV4dC5wcmVmaXhDbGFzcygndGFiLWJhci1pdGVtcycpfVxuICAgICAgICAgICAgICAgIGhBbGlnbj1cImNlbnRlclwiXG4gICAgICAgICAgICAgICAgdkFsaWduPVwiY2VudGVyXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7UmVhY3QuQ2hpbGRyZW4ubWFwKHQucHJvcHMuY2hpbGRyZW4sIChjaGlsZCwgaWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8VGFiQmFySXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17aWR4fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW09e2NoaWxkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZT17aWR4PT09dC5zdGF0ZS5hY3RpdmVJbmRleH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0Lm9uSXRlbUNsaWNrLmJpbmQodCwgaWR4KX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICA8L0hCb3g+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyQ29udGVudHMoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtDb250ZXh0LnByZWZpeENsYXNzKCd0YWItYmFyLWNvbnRlbnRzJyl9PlxuICAgICAgICAgICAge1JlYWN0LkNoaWxkcmVuLm1hcCh0LnByb3BzLmNoaWxkcmVuLCAoY2hpbGQsIGlkeCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYga2V5PXtpZHh9IGNsYXNzTmFtZT17Y2xhc3NuYW1lcyhDb250ZXh0LnByZWZpeENsYXNzKCd0YWItYmFyLWNvbnRlbnQnKSwge1xuICAgICAgICAgICAgICAgICAgICAnYWN0aXZlJzogaWR4ID09PSB0LnN0YXRlLmFjdGl2ZUluZGV4XG4gICAgICAgICAgICAgICAgfSl9PntjaGlsZC5wcm9wcyAmJiBjaGlsZC5wcm9wcy5jaGlsZHJlbn08L2Rpdj5cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KX1cbiAgICAgICAgPC9kaXY+XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiA8ZGl2IHJlZj0ncm9vdCcgY2xhc3NOYW1lPXtjbGFzc25hbWVzKENvbnRleHQucHJlZml4Q2xhc3MoJ3RhYi1iYXInKSwge1xuICAgICAgICAgICAgW3QucHJvcHMuY2xhc3NOYW1lXTogISF0LnByb3BzLmNsYXNzTmFtZVxuICAgICAgICB9KX0+XG4gICAgICAgICAgICB7dC5yZW5kZXJDb250ZW50cygpfVxuICAgICAgICAgICAge3QucmVuZGVySXRlbXMoKX1cbiAgICAgICAgPC9kaXY+O1xuICAgIH1cbn1cblRhYkJhci5JdGVtID0gVGFiQmFySXRlbTtcblxuZXhwb3J0IGRlZmF1bHQgVGFiQmFyO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
