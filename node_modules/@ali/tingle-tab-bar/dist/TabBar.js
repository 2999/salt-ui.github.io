'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**
 * TabBar Component for tingle
 * @author zhouwenjie
 *
 * Copyright 2014-2016, Tingle Team.
 * All rights reserved.
 */
var React = require('react');
var classnames = require('classnames');
var Context = require('@ali/tingle-context');

var _require = require('@ali/tingle-box'),
    HBox = _require.HBox;

var TabBarItem = require('./TabBarItem');

var TabBar = function (_React$Component) {
  _inherits(TabBar, _React$Component);

  function TabBar(props) {
    _classCallCheck(this, TabBar);

    var _this = _possibleConstructorReturn(this, (TabBar.__proto__ || Object.getPrototypeOf(TabBar)).call(this, props));

    _this.state = {
      activeIndex: props.activeIndex
    };
    return _this;
  }

  _createClass(TabBar, [{
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      var t = this;
      var nextActiveIndex = nextProps.activeIndex;
      if (nextActiveIndex !== t.state.activeIndex) {
        t.setActiveIndex(nextActiveIndex);
      }
    }
  }, {
    key: 'onItemClick',
    value: function onItemClick(index) {
      if (index !== this.state.activeIndex) {
        this.setActiveIndex(index);
      }
    }
  }, {
    key: 'setActiveIndex',
    value: function setActiveIndex(index) {
      var t = this;
      t.setState({
        activeIndex: index
      }, function () {
        t.props.onChange(index);
      });
    }
  }, {
    key: 'renderItems',
    value: function renderItems() {
      var t = this;
      return React.createElement(
        HBox,
        {
          className: Context.prefixClass('tab-bar-items'),
          style: t.props.tabBarStyle,
          hAlign: 'center',
          vAlign: 'center'
        },
        React.Children.map(t.props.children, function (child, idx) {
          if (!child) {
            return null;
          }
          return React.createElement(TabBarItem, {
            key: idx,
            item: child,
            active: idx === t.state.activeIndex,
            onClick: t.onItemClick.bind(t, idx)
          });
        })
      );
    }
  }, {
    key: 'renderContents',
    value: function renderContents() {
      var t = this;
      var contents = React.Children.map(t.props.children, function (child, idx) {
        if (!child || !child.props.children) {
          return null;
        }
        var className = classnames(Context.prefixClass('tab-bar-content'), {
          'active': idx === t.state.activeIndex
        });
        return React.createElement(
          'div',
          { key: idx, className: className },
          child.props && child.props.children
        );
      });
      var noContents = !contents || contents.every(function (content) {
        return content == null;
      });
      if (noContents) {
        return null;
      }
      return React.createElement(
        'div',
        { className: Context.prefixClass('tab-bar-contents') },
        contents
      );
    }
  }, {
    key: 'render',
    value: function render() {
      var t = this;
      var className = classnames(Context.prefixClass('tab-bar'), _defineProperty({}, t.props.className, !!t.props.className));
      return React.createElement(
        'div',
        { ref: 'root', className: className },
        t.renderContents(),
        t.renderItems()
      );
    }
  }]);

  return TabBar;
}(React.Component);

TabBar.displayName = 'TabBar';
TabBar.propTypes = {
  className: React.PropTypes.string,
  activeIndex: React.PropTypes.number,
  onChange: React.PropTypes.func,
  tabBarStyle: React.PropTypes.object
};
TabBar.defaultProps = {
  activeIndex: 0,
  onChange: function onChange() {}
};

TabBar.Item = TabBarItem;

module.exports = TabBar;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRhYkJhci5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJjbGFzc25hbWVzIiwiQ29udGV4dCIsIkhCb3giLCJUYWJCYXJJdGVtIiwiVGFiQmFyIiwicHJvcHMiLCJzdGF0ZSIsImFjdGl2ZUluZGV4IiwibmV4dFByb3BzIiwidCIsIm5leHRBY3RpdmVJbmRleCIsInNldEFjdGl2ZUluZGV4IiwiaW5kZXgiLCJzZXRTdGF0ZSIsIm9uQ2hhbmdlIiwicHJlZml4Q2xhc3MiLCJ0YWJCYXJTdHlsZSIsIkNoaWxkcmVuIiwibWFwIiwiY2hpbGRyZW4iLCJjaGlsZCIsImlkeCIsIm9uSXRlbUNsaWNrIiwiYmluZCIsImNvbnRlbnRzIiwiY2xhc3NOYW1lIiwibm9Db250ZW50cyIsImV2ZXJ5IiwiY29udGVudCIsInJlbmRlckNvbnRlbnRzIiwicmVuZGVySXRlbXMiLCJDb21wb25lbnQiLCJkaXNwbGF5TmFtZSIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyIsIm51bWJlciIsImZ1bmMiLCJvYmplY3QiLCJkZWZhdWx0UHJvcHMiLCJJdGVtIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7QUFPQSxJQUFNQSxRQUFRQyxRQUFRLE9BQVIsQ0FBZDtBQUNBLElBQU1DLGFBQWFELFFBQVEsWUFBUixDQUFuQjtBQUNBLElBQU1FLFVBQVVGLFFBQVEscUJBQVIsQ0FBaEI7O2VBQ2VBLFFBQVEsaUJBQVIsQztJQUFSRyxJLFlBQUFBLEk7O0FBQ1AsSUFBTUMsYUFBYUosUUFBUSxjQUFSLENBQW5COztJQUVNSyxNOzs7QUFjSixrQkFBWUMsS0FBWixFQUFtQjtBQUFBOztBQUFBLGdIQUNYQSxLQURXOztBQUVqQixVQUFLQyxLQUFMLEdBQWE7QUFDWEMsbUJBQWFGLE1BQU1FO0FBRFIsS0FBYjtBQUZpQjtBQUtsQjs7Ozs4Q0FFeUJDLFMsRUFBVztBQUNuQyxVQUFJQyxJQUFJLElBQVI7QUFDQSxV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RUFyR2tCaEMsTUFBTWlDLFM7O0FBQXJCM0IsTSxDQUNHNEIsVyxHQUFjLFE7QUFEakI1QixNLENBRUc2QixTLEdBQVk7QUFDakJSLGFBQVczQixNQUFNb0MsU0FBTixDQUFnQkMsTUFEVjtBQUVqQjVCLGVBQWFULE1BQU1vQyxTQUFOLENBQWdCRSxNQUZaO0FBR2pCdEIsWUFBVWhCLE1BQU1vQyxTQUFOLENBQWdCRyxJQUhUO0FBSWpCckIsZUFBYWxCLE1BQU1vQyxTQUFOLENBQWdCSTtBQUpaLEM7QUFGZmxDLE0sQ0FRR21DLFksR0FBZTtBQUNwQmhDLGVBQWEsQ0FETztBQUVwQk8sWUFBVSxvQkFBSyxDQUNkO0FBSG1CLEM7O0FBK0Z4QlYsT0FBT29DLElBQVAsR0FBY3JDLFVBQWQ7O0FBRUFzQyxPQUFPQyxPQUFQLEdBQWlCdEMsTUFBakIiLCJmaWxlIjoiVGFiQmFyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUYWJCYXIgQ29tcG9uZW50IGZvciB0aW5nbGVcbiAqIEBhdXRob3IgemhvdXdlbmppZVxuICpcbiAqIENvcHlyaWdodCAyMDE0LTIwMTYsIFRpbmdsZSBUZWFtLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuY29uc3QgY2xhc3NuYW1lcyA9IHJlcXVpcmUoJ2NsYXNzbmFtZXMnKTtcbmNvbnN0IENvbnRleHQgPSByZXF1aXJlKCdAYWxpL3RpbmdsZS1jb250ZXh0Jyk7XG5jb25zdCB7SEJveH0gPSByZXF1aXJlKCdAYWxpL3RpbmdsZS1ib3gnKTtcbmNvbnN0IFRhYkJhckl0ZW0gPSByZXF1aXJlKCcuL1RhYkJhckl0ZW0nKTtcblxuY2xhc3MgVGFiQmFyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgc3RhdGljIGRpc3BsYXlOYW1lID0gJ1RhYkJhcic7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgY2xhc3NOYW1lOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuICAgIGFjdGl2ZUluZGV4OiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgIG9uQ2hhbmdlOiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcbiAgICB0YWJCYXJTdHlsZTogUmVhY3QuUHJvcFR5cGVzLm9iamVjdCxcbiAgfTtcbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBhY3RpdmVJbmRleDogMCxcbiAgICBvbkNoYW5nZTogKCk9PiB7XG4gICAgfSxcbiAgfTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgYWN0aXZlSW5kZXg6IHByb3BzLmFjdGl2ZUluZGV4LFxuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgbGV0IHQgPSB0aGlzO1xuICAgIGNvbnN0IG5leHRBY3RpdmVJbmRleCA9IG5leHRQcm9wcy5hY3RpdmVJbmRleDtcbiAgICBpZiAobmV4dEFjdGl2ZUluZGV4ICE9PSB0LnN0YXRlLmFjdGl2ZUluZGV4KSB7XG4gICAgICB0LnNldEFjdGl2ZUluZGV4KG5leHRBY3RpdmVJbmRleCk7XG4gICAgfVxuICB9XG5cbiAgb25JdGVtQ2xpY2soaW5kZXgpIHtcbiAgICBpZiAoaW5kZXggIT09IHRoaXMuc3RhdGUuYWN0aXZlSW5kZXgpIHtcbiAgICAgIHRoaXMuc2V0QWN0aXZlSW5kZXgoaW5kZXgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEFjdGl2ZUluZGV4KGluZGV4KSB7XG4gICAgY29uc3QgdCA9IHRoaXM7XG4gICAgdC5zZXRTdGF0ZSh7XG4gICAgICBhY3RpdmVJbmRleDogaW5kZXhcbiAgICB9LCAoKT0+IHtcbiAgICAgIHQucHJvcHMub25DaGFuZ2UoaW5kZXgpO1xuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgY29uc3QgdCA9IHRoaXM7XG4gICAgcmV0dXJuIChcbiAgICAgIDxIQm94XG4gICAgICAgIGNsYXNzTmFtZT17Q29udGV4dC5wcmVmaXhDbGFzcygndGFiLWJhci1pdGVtcycpfVxuICAgICAgICBzdHlsZT17dC5wcm9wcy50YWJCYXJTdHlsZX1cbiAgICAgICAgaEFsaWduPVwiY2VudGVyXCJcbiAgICAgICAgdkFsaWduPVwiY2VudGVyXCJcbiAgICAgID5cbiAgICAgICAge1JlYWN0LkNoaWxkcmVuLm1hcCh0LnByb3BzLmNoaWxkcmVuLCAoY2hpbGQsIGlkeCkgPT4ge1xuICAgICAgICAgIGlmICghY2hpbGQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFRhYkJhckl0ZW1cbiAgICAgICAgICAgICAga2V5PXtpZHh9XG4gICAgICAgICAgICAgIGl0ZW09e2NoaWxkfVxuICAgICAgICAgICAgICBhY3RpdmU9e2lkeD09PXQuc3RhdGUuYWN0aXZlSW5kZXh9XG4gICAgICAgICAgICAgIG9uQ2xpY2s9e3Qub25JdGVtQ2xpY2suYmluZCh0LCBpZHgpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApO1xuICAgICAgICB9KX1cbiAgICAgIDwvSEJveD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyQ29udGVudHMoKSB7XG4gICAgY29uc3QgdCA9IHRoaXM7XG4gICAgY29uc3QgY29udGVudHMgPSBSZWFjdC5DaGlsZHJlbi5tYXAodC5wcm9wcy5jaGlsZHJlbiwgKGNoaWxkLCBpZHgpID0+IHtcbiAgICAgIGlmICghY2hpbGQgfHwgIWNoaWxkLnByb3BzLmNoaWxkcmVuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgY2xhc3NOYW1lID0gY2xhc3NuYW1lcyhDb250ZXh0LnByZWZpeENsYXNzKCd0YWItYmFyLWNvbnRlbnQnKSwge1xuICAgICAgICAnYWN0aXZlJzogaWR4ID09PSB0LnN0YXRlLmFjdGl2ZUluZGV4XG4gICAgICB9KTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYga2V5PXtpZHh9IGNsYXNzTmFtZT17Y2xhc3NOYW1lfT57Y2hpbGQucHJvcHMgJiYgY2hpbGQucHJvcHMuY2hpbGRyZW59PC9kaXY+XG4gICAgICApO1xuICAgIH0pO1xuICAgIGNvbnN0IG5vQ29udGVudHMgPSAhY29udGVudHMgfHwgY29udGVudHMuZXZlcnkoY29udGVudCA9PiBjb250ZW50ID09IG51bGwpO1xuICAgIGlmIChub0NvbnRlbnRzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtDb250ZXh0LnByZWZpeENsYXNzKCd0YWItYmFyLWNvbnRlbnRzJyl9PlxuICAgICAge2NvbnRlbnRzfVxuICAgIDwvZGl2PlxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHQgPSB0aGlzO1xuICAgIGNvbnN0IGNsYXNzTmFtZSA9IGNsYXNzbmFtZXMoQ29udGV4dC5wcmVmaXhDbGFzcygndGFiLWJhcicpLCB7XG4gICAgICBbdC5wcm9wcy5jbGFzc05hbWVdOiAhIXQucHJvcHMuY2xhc3NOYW1lXG4gICAgfSk7XG4gICAgcmV0dXJuIDxkaXYgcmVmPSdyb290JyBjbGFzc05hbWU9e2NsYXNzTmFtZX0+XG4gICAgICB7dC5yZW5kZXJDb250ZW50cygpfVxuICAgICAge3QucmVuZGVySXRlbXMoKX1cbiAgICA8L2Rpdj47XG4gIH1cbn1cblRhYkJhci5JdGVtID0gVGFiQmFySXRlbTtcblxubW9kdWxlLmV4cG9ydHMgPSBUYWJCYXI7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
